
x = torch.tensor([1.,2,3,4,5,6,7,1,2,3,8,9,10,7,1,2,3,8,9,10,7,1,2,3,8,9,10,7,1,2,3,7,1,2,3,8,9,10,7,1,2,3,7,1,2],requires_grad=True).cuda()


centers[10,1] = 

tensor([[0.5000],
        [1.5000],
        [2.5000],
        [3.5000],
        [4.5000],
        [5.5000],
        [6.5000],
        [7.5000],
        [8.5000],
        [9.5000]], device='cuda:0')

centers_same_shape[]
=


x_[1,45] =
tensor([[ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  1.,  2.,  3.,  8.,  9., 10.,  7.,
          1.,  2.,  3.,  8.,  9., 10.,  7.,  1.,  2.,  3.,  8.,  9., 10.,  7.,
          1.,  2.,  3.,  7.,  1.,  2.,  3.,  8.,  9., 10.,  7.,  1.,  2.,  3.,
          7.,  1.,  2.]], device='cuda:0', grad_fn=<UnsqueezeBackward0>)
		  
x1[10,45] = centers - x_ =


#largest data [bins,len]


[1              [-2,-3,-4
 2  -[3,4 5] =   -1,-2,-3
 3]               0,-1,-2]


tensor([[-0.5000, -1.5000, -2.5000, -3.5000, -4.5000, -5.5000, -6.5000, -0.5000,
         -1.5000, -2.5000, -7.5000, -8.5000, -9.5000, -6.5000, -0.5000, -1.5000,
         -2.5000, -7.5000, -8.5000, -9.5000, -6.5000, -0.5000, -1.5000, -2.5000,
         -7.5000, -8.5000, -9.5000, -6.5000, -0.5000, -1.5000, -2.5000, -6.5000,
         -0.5000, -1.5000, -2.5000, -7.5000, -8.5000, -9.5000, -6.5000, -0.5000,
         -1.5000, -2.5000, -6.5000, -0.5000, -1.5000],
        [ 0.5000, -0.5000, -1.5000, -2.5000, -3.5000, -4.5000, -5.5000,  0.5000,
         -0.5000, -1.5000, -6.5000, -7.5000, -8.5000, -5.5000,  0.5000, -0.5000,
         -1.5000, -6.5000, -7.5000, -8.5000, -5.5000,  0.5000, -0.5000, -1.5000,
         -6.5000, -7.5000, -8.5000, -5.5000,  0.5000, -0.5000, -1.5000, -5.5000,
          0.5000, -0.5000, -1.5000, -6.5000, -7.5000, -8.5000, -5.5000,  0.5000,
         -0.5000, -1.5000, -5.5000,  0.5000, -0.5000],
        [ 1.5000,  0.5000, -0.5000, -1.5000, -2.5000, -3.5000, -4.5000,  1.5000,
          0.5000, -0.5000, -5.5000, -6.5000, -7.5000, -4.5000,  1.5000,  0.5000,
         -0.5000, -5.5000, -6.5000, -7.5000, -4.5000,  1.5000,  0.5000, -0.5000,
         -5.5000, -6.5000, -7.5000, -4.5000,  1.5000,  0.5000, -0.5000, -4.5000,
          1.5000,  0.5000, -0.5000, -5.5000, -6.5000, -7.5000, -4.5000,  1.5000,
          0.5000, -0.5000, -4.5000,  1.5000,  0.5000],
        [ 2.5000,  1.5000,  0.5000, -0.5000, -1.5000, -2.5000, -3.5000,  2.5000,
          1.5000,  0.5000, -4.5000, -5.5000, -6.5000, -3.5000,  2.5000,  1.5000,
          0.5000, -4.5000, -5.5000, -6.5000, -3.5000,  2.5000,  1.5000,  0.5000,
         -4.5000, -5.5000, -6.5000, -3.5000,  2.5000,  1.5000,  0.5000, -3.5000,
          2.5000,  1.5000,  0.5000, -4.5000, -5.5000, -6.5000, -3.5000,  2.5000,
          1.5000,  0.5000, -3.5000,  2.5000,  1.5000],
        [ 3.5000,  2.5000,  1.5000,  0.5000, -0.5000, -1.5000, -2.5000,  3.5000,
          2.5000,  1.5000, -3.5000, -4.5000, -5.5000, -2.5000,  3.5000,  2.5000,
          1.5000, -3.5000, -4.5000, -5.5000, -2.5000,  3.5000,  2.5000,  1.5000,
         -3.5000, -4.5000, -5.5000, -2.5000,  3.5000,  2.5000,  1.5000, -2.5000,
          3.5000,  2.5000,  1.5000, -3.5000, -4.5000, -5.5000, -2.5000,  3.5000,
          2.5000,  1.5000, -2.5000,  3.5000,  2.5000],
        [ 4.5000,  3.5000,  2.5000,  1.5000,  0.5000, -0.5000, -1.5000,  4.5000,
          3.5000,  2.5000, -2.5000, -3.5000, -4.5000, -1.5000,  4.5000,  3.5000,
          2.5000, -2.5000, -3.5000, -4.5000, -1.5000,  4.5000,  3.5000,  2.5000,
         -2.5000, -3.5000, -4.5000, -1.5000,  4.5000,  3.5000,  2.5000, -1.5000,
          4.5000,  3.5000,  2.5000, -2.5000, -3.5000, -4.5000, -1.5000,  4.5000,
          3.5000,  2.5000, -1.5000,  4.5000,  3.5000],
        [ 5.5000,  4.5000,  3.5000,  2.5000,  1.5000,  0.5000, -0.5000,  5.5000,
          4.5000,  3.5000, -1.5000, -2.5000, -3.5000, -0.5000,  5.5000,  4.5000,
          3.5000, -1.5000, -2.5000, -3.5000, -0.5000,  5.5000,  4.5000,  3.5000,
         -1.5000, -2.5000, -3.5000, -0.5000,  5.5000,  4.5000,  3.5000, -0.5000,
          5.5000,  4.5000,  3.5000, -1.5000, -2.5000, -3.5000, -0.5000,  5.5000,
          4.5000,  3.5000, -0.5000,  5.5000,  4.5000],
        [ 6.5000,  5.5000,  4.5000,  3.5000,  2.5000,  1.5000,  0.5000,  6.5000,
          5.5000,  4.5000, -0.5000, -1.5000, -2.5000,  0.5000,  6.5000,  5.5000,
          4.5000, -0.5000, -1.5000, -2.5000,  0.5000,  6.5000,  5.5000,  4.5000,
         -0.5000, -1.5000, -2.5000,  0.5000,  6.5000,  5.5000,  4.5000,  0.5000,
          6.5000,  5.5000,  4.5000, -0.5000, -1.5000, -2.5000,  0.5000,  6.5000,
          5.5000,  4.5000,  0.5000,  6.5000,  5.5000],
        [ 7.5000,  6.5000,  5.5000,  4.5000,  3.5000,  2.5000,  1.5000,  7.5000,
          6.5000,  5.5000,  0.5000, -0.5000, -1.5000,  1.5000,  7.5000,  6.5000,
          5.5000,  0.5000, -0.5000, -1.5000,  1.5000,  7.5000,  6.5000,  5.5000,
          0.5000, -0.5000, -1.5000,  1.5000,  7.5000,  6.5000,  5.5000,  1.5000,
          7.5000,  6.5000,  5.5000,  0.5000, -0.5000, -1.5000,  1.5000,  7.5000,
          6.5000,  5.5000,  1.5000,  7.5000,  6.5000],
        [ 8.5000,  7.5000,  6.5000,  5.5000,  4.5000,  3.5000,  2.5000,  8.5000,
          7.5000,  6.5000,  1.5000,  0.5000, -0.5000,  2.5000,  8.5000,  7.5000,
          6.5000,  1.5000,  0.5000, -0.5000,  2.5000,  8.5000,  7.5000,  6.5000,
          1.5000,  0.5000, -0.5000,  2.5000,  8.5000,  7.5000,  6.5000,  2.5000,
          8.5000,  7.5000,  6.5000,  1.5000,  0.5000, -0.5000,  2.5000,  8.5000,
          7.5000,  6.5000,  2.5000,  8.5000,  7.5000]], device='cuda:0',
       grad_fn=<SubBackward0>)
	   
x1